{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/Company_project/NewProject_8/assets/Script/avatar.ts"],"names":["_decorator","Component","Node","Sprite","SpriteAtlas","UITransform","resources","ccclass","property","Avatar","updateAvatar","name","id","index","console","log","self","node","getChildByName","parts","avatarNode","addChild","addComponent","transform","getComponent","sprite","setPosition","setAnchorPoint","trim","sizeMode","SizeMode","CUSTOM","setContentSize","contentSize","load","err","altas","spriteAtlas","updateFrame","priority","part","action","framecount","changeSpriteFrameFromAtlas","start"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Component, Node, Sprite, SpriteAtlas, UITransform, resources, SpriteFrame, Animation, Texture2D } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Avatar')\r\nexport class Avatar extends Component {\r\n\r\n    parts: { [name: string]: any } = [];\r\n    nowAni: string = 'idle';\r\n    updateAvatar(name: string, id: number, index: number) {\r\n        console.log(name);\r\n        let self = this;\r\n        if (this.node.getChildByName(name) == null) {\r\n\r\n            this.parts[name] = { index: index, id: -1 };\r\n\r\n            let avatarNode = new Node(name);\r\n            this.node.addChild(avatarNode);\r\n\r\n            avatarNode.addComponent(UITransform);\r\n            let transform = avatarNode.getComponent(UITransform);\r\n            let sprite = avatarNode.addComponent(Sprite);\r\n\r\n            avatarNode.setPosition(0, 0);\r\n            transform?.setAnchorPoint(0.5, 0);\r\n            sprite.trim = false;\r\n            sprite.sizeMode = Sprite.SizeMode.CUSTOM;\r\n            transform!.setContentSize(56, 45);\r\n            console.log(transform?.contentSize);\r\n            resources.load('textures/avatar_test', SpriteAtlas, (err, altas: SpriteAtlas) => {\r\n                // console.log(err);\r\n                sprite.spriteAtlas = altas;\r\n                self.updateFrame(name, id, 'idle', 0);\r\n\r\n            });\r\n            transform!.priority = index;\r\n        }\r\n        else\r\n            this.updateFrame(name, id, 'idle', 0);\r\n        return this.node.getChildByName(name);\r\n\r\n    }\r\n    updateFrame(part: string, id: number, action: string, framecount: number) {\r\n        this.node.getChildByName(part)?.getComponent(Sprite)?.changeSpriteFrameFromAtlas(part + '_' + id + '_' + action + '_' + framecount);\r\n    }\r\n\r\n    start() {\r\n        this.updateAvatar('body', 0, 0);\r\n        this.updateAvatar('cost', 0, 1);\r\n        this.updateAvatar('hair', 0, 2);\r\n    }\r\n\r\n}\r\n\r\n\r\n/**\r\n * [1] Class member could be defined like this.\r\n * [2] Use `property` decorator if your want the member to be serializable.\r\n * [3] Your initialization goes here.\r\n * [4] Your update function goes here.\r\n *\r\n * Learn more about scripting: https://docs.cocos.com/creator/3.0/manual/en/scripting/\r\n * Learn more about CCClass: https://docs.cocos.com/creator/3.0/manual/en/scripting/ccclass.html\r\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.0/manual/en/scripting/life-cycle-callbacks.html\r\n */\r\n"]}
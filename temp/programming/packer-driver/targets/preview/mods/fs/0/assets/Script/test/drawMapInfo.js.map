{"version":3,"sources":["file:///C:/Users/Administrator/Desktop/Company_project/NewProject_8/assets/Script/test/drawMapInfo.ts"],"names":["_decorator","Component","Node","Graphics","Prefab","instantiate","UITransform","Sprite","Color","Util_CreateRandMap","UntilRandTerrain","UntilRelationship","UtilEvent","ccclass","property","DrawMapInfo","onLoad","start","graphics","node","getComponent","RoomList","initRoomList","MainRoomList","MainRoom","ViceRoomList","ViceRoom","roadRect","createConnectedRoad","forEach","val","unit_road","road_unit","setPosition","x","UNIT_SIZE","y","setContentSize","w","h","addChild","rect","stroke","mid","mid_p","i","unit","room_unit","test_terrain_info","id","area","t","createOne","j","t_unit","terrain","color","createEvent","result","getTown","console","log","EveMag","getAEveMag","addEvent","getARandEvent","getPool","update","deltaTime","camera"],"mappings":"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","sourcesContent":["import {\r\n  _decorator,\r\n  Component,\r\n  Node,\r\n  Graphics,\r\n  Prefab,\r\n  instantiate,\r\n  UITransform,\r\n  Sprite,\r\n  Color,\r\n} from \"cc\";\r\nimport { Util_CreateRandMap } from \"../Util_CreateRandMap\";\r\nimport { Util_SimpleMath } from \"../Util_SimpleMath\";\r\nimport { UntilRandTerrain } from \"../until_randomTerrain\";\r\nimport { UntilRelationship } from \"../Until_Relationship\";\r\nimport { UtilEvent } from \"../Util_Event\";\r\nimport { UntilJsonInit } from \"../Until_JsonInit\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass(\"DrawMapInfo\")\r\nexport class DrawMapInfo extends Component {\r\n  // [1]\r\n  // dummy = '';\r\n\r\n  // [2]\r\n  @property(Prefab)\r\n  room_unit: Prefab | null = null;\r\n\r\n  @property(Prefab)\r\n  road_unit: Prefab | null = null;\r\n\r\n  @property(Node)\r\n  camera: Node | null = null;\r\n\r\n  @property(Prefab)\r\n  terrain: Prefab | null = null;\r\n\r\n  UNIT_SIZE = 5;\r\n  mid: any;\r\n  onLoad() {}\r\n  start() {\r\n    let graphics = this.node.getComponent(Graphics);\r\n    const RoomList = Util_CreateRandMap.initRoomList(8, 20, 20, 10, 10);\r\n    //返回了一个room对象\r\n    const MainRoomList = RoomList.MainRoom;\r\n    const ViceRoomList = RoomList.ViceRoom;\r\n    const roadRect = Util_CreateRandMap.createConnectedRoad(\r\n      MainRoomList,\r\n      ViceRoomList\r\n    );\r\n    roadRect.forEach((val) => {\r\n      let unit_road = instantiate(this.road_unit!);\r\n      unit_road.setPosition(val.x * this.UNIT_SIZE, val.y * this.UNIT_SIZE);\r\n      unit_road\r\n        .getComponent(UITransform)\r\n        ?.setContentSize(val.w * this.UNIT_SIZE, val.h * this.UNIT_SIZE);\r\n      this.node.addChild(unit_road);\r\n      graphics?.rect(\r\n        val.x * this.UNIT_SIZE,\r\n        val.y * this.UNIT_SIZE,\r\n        this.UNIT_SIZE * val.w,\r\n        this.UNIT_SIZE * val.h\r\n      );\r\n\r\n      graphics?.stroke();\r\n    });\r\n\r\n    this.mid = RoomList.mid_p;\r\n    MainRoomList.forEach((val, i) => {\r\n      let unit = instantiate(this.room_unit!);\r\n      unit.setPosition(val.x * this.UNIT_SIZE, val.y * this.UNIT_SIZE);\r\n      unit\r\n        .getComponent(UITransform)\r\n        ?.setContentSize(val.w * this.UNIT_SIZE, val.h * this.UNIT_SIZE);\r\n      this.node.addChild(unit);\r\n      // unit.getComponent(MapUnitInfo)?.updateLabel('房间' + i + \"x,y:\" + unit.position.x / this.UNIT_SIZE + \",\" + unit.position.y / this.UNIT_SIZE);\r\n      graphics?.rect(\r\n        val.x * this.UNIT_SIZE,\r\n        val.y * this.UNIT_SIZE,\r\n        this.UNIT_SIZE * val.w,\r\n        this.UNIT_SIZE * val.h\r\n      );\r\n\r\n      graphics?.stroke();\r\n    });\r\n\r\n    let test_terrain_info: any[] = [];\r\n    test_terrain_info[0] = { id: 1, area: 0.2 };\r\n    test_terrain_info[1] = { id: 2, area: 0.35 };\r\n    let t = UntilRandTerrain.createOne(MainRoomList[0], test_terrain_info);\r\n\r\n    //init\r\n    // this.createEvent();\r\n\r\n    for (let i = 0; i < MainRoomList[0].w; i++) {\r\n      for (let j = 0; j < MainRoomList[0].h; j++) {\r\n        if (t[i][j] != -1) {\r\n          let t_unit = instantiate(this.terrain!);\r\n          t_unit.setPosition(\r\n            (i + MainRoomList[0].x) * this.UNIT_SIZE,\r\n            (j + MainRoomList[0].y) * this.UNIT_SIZE\r\n          );\r\n          // console.log(i, j);\r\n          t_unit\r\n            .getComponent(UITransform)\r\n            ?.setContentSize(this.UNIT_SIZE, this.UNIT_SIZE);\r\n          t_unit.getComponent(Sprite)!.color = new Color(\r\n            t[i][j] * 45,\r\n            255 - t[i][j] * 45,\r\n            t[i][j] * 45\r\n          );\r\n          this.node.addChild(t_unit);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  createEvent() {\r\n    //小镇家族\r\n    let result = UntilRelationship.getTown(7);\r\n    console.log(result);\r\n\r\n    //随机事件\r\n    let EveMag = UtilEvent.getAEveMag();\r\n    EveMag.addEvent(UtilEvent.getARandEvent(result, true));\r\n\r\n    console.log(EveMag.getPool()[0]);\r\n  }\r\n\r\n  update(deltaTime: number) {\r\n    this.camera?.setPosition(\r\n      this.mid.x * this.UNIT_SIZE,\r\n      this.mid.y * this.UNIT_SIZE\r\n    );\r\n  }\r\n}\r\n"]}